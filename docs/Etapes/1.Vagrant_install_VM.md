# Ã‰tape 1 â€” Installation des VM (Vagrant) ğŸ§±ğŸ–¥ï¸

> Objectif : disposer dâ€™un **lab local reproductible** (rejouable Ã  lâ€™identique) pour dÃ©marrer le Sprint 1 : **socle infra K3s**.  
> RÃ©sultat : **4 VM** prÃªtes (3 masters + 1 worker) et dÃ©marrÃ©es.

---

## âœ… Ce que nous avons fait

### ğŸ§° 1) PrÃ©parer lâ€™environnement Vagrant
- Utilisation de **Vagrant** (outil de provisioning de VM : il automatise crÃ©ation/dÃ©marrage/config de machines virtuelles).
- Utilisation de **VirtualBox** (hyperviseur : logiciel qui exÃ©cute les VM sur ton PC).

### ğŸ—ºï¸ 2) DÃ©finir lâ€™infrastructure dans `Vagrantfile`
Le `Vagrantfile` (fichier de description dâ€™infra Vagrant) dÃ©finit :
- ğŸ“¦ Lâ€™OS : `ubuntu/jammy64` (Ubuntu 22.04)
- ğŸ§  Ressources : CPU/RAM par VM
- ğŸŒ RÃ©seau : `private_network` (rÃ©seau privÃ© local) avec IP fixes
- ğŸ§© Provisioning : quelques commandes de prÃ©paration (paquets, SSH, swap off)

### ğŸ—ï¸ 3) CrÃ©er et dÃ©marrer les VM
Commandes exÃ©cutÃ©es :
- `vagrant up` : crÃ©e et dÃ©marre les VM (et applique la config).
- `vagrant status` : vÃ©rifie lâ€™Ã©tat des VM.

---

## ğŸ§¾ Ã‰tat obtenu (attendu)

### ğŸ–¥ï¸ Machines virtuelles
- ğŸ§­ `master1` â€” **running**
- ğŸ§­ `master2` â€” **running**
- ğŸ§­ `master3` â€” **running**
- ğŸ§± `worker1` â€” **running**

> Ton retour `vagrant status` confirme que tout est **OK** âœ…

---

## ğŸ” Pourquoi câ€™est â€œDevSecOps-friendlyâ€ dÃ¨s maintenant

- â™»ï¸ **Reproductible** : le lab est dÃ©crit comme du â€œcode dâ€™infraâ€ dans `Vagrantfile` (mÃªme rÃ©sultat Ã  chaque exÃ©cution).
- ğŸ” **Rollback facile** : tu peux dÃ©truire et recrÃ©er proprement.
- ğŸ§© **Base saine pour Kubernetes/K3s** : prÃ©requis systÃ¨me appliquÃ©s (ex. swap dÃ©sactivÃ©) pour Ã©viter des comportements imprÃ©visibles.

---

## ğŸ§¨ Commandes utiles (au cas oÃ¹)

- ğŸ” Voir lâ€™Ã©tat :
  - `vagrant status`
- ğŸ”‘ Se connecter en SSH (Secure Shell : connexion distante en terminal) :
  - `vagrant ssh master1`
- â™»ï¸ Ã‰teindre :
  - `vagrant halt`
- ğŸ’£ DÃ©truire (reset total) :
  - `vagrant destroy -f`
- ğŸ§¼ Rejouer proprement :
  - `vagrant destroy -f && vagrant up`

---

## ğŸ§± Note importante : Docker DHI (Ã  garder en tÃªte) ğŸ›¡ï¸ğŸ³

Nous appliquerons ensuite une politique **DHI** (Docker Hardened Images : images Docker minimales et durcies, orientÃ©es rÃ©duction de vulnÃ©rabilitÃ©s et conformitÃ©) pour toutes les images de base utilisÃ©es dans nos conteneurs.  
ğŸ‘‰ RÃ©fÃ©rence : https://docs.docker.com/dhi/

---

## â­ï¸ Prochaine Ã©tape (Ã‰tape 2)
â¡ï¸ **Connexion Ansible aux VM** (inventaire + accÃ¨s SSH) puis installation **K3s** de maniÃ¨re idempotente (idempotent = rejouable sans casser, le rÃ©sultat final reste le mÃªme).

Quand tu es prÃªt, dis : **OK Ã‰tape 2**.
